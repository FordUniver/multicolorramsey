% Preliminaries section - basic definitions only
% This section contains the fundamental definitions needed for the formalization

\section{Preliminaries}


\subsection{Elementary combinatorics}

% [LEMMA] Multinomial coefficient bound (Appendix lemma)
% Source: blueprint/paper/sections/section_bounding_binomial_coefficients.tex line 5 (\begin{lemma}\label{lem:multibounds})
% Deprecated blueprint: deprecated/02_Preliminaries.tex line 30-40 (\begin{lemma}[Lemma A.1])
% Lean status: ✗ Not implemented
% Label: lem:multibounds
% Dependencies: None (elementary combinatorics)
% TODO: Add bound for multinomial coefficient with exponential decay

\begin{lemma}[Multinomial coefficient bound]
  \label{lem:multibounds} % Source paper uses same label
  \paperref{Lemma A.1}
  %
  For each $k,t,r \in \N$ with $3 \le t \le k$, we have
  $$\binom{rk-t}{k,\dots,k,k-t} \le e^{-(r-1)t^2/3rk} r^{rk-t}.$$
\end{lemma}
%
\begin{proof}
  To prove this, observe that 
  $$\binom{rk-t}{k,\dots,k,k-t} \binom{rk}{k,\dots,k}^{-1} = \, \prod_{i = 0}^{t - 1} \frac{k - i}{rk - i} = r^{-t} \,\prod_{i = 0}^{t-1} \bigg( 1 - \frac{(r-1)i}{rk - i} \bigg) \le r^{-t} \cdot e^{-(r-1)t^2/3rk}.$$
  Since $\binom{rk}{k,\dots,k} \le r^{rk}$, the claimed bound follows.
\end{proof}


\subsection{Graphs and colourings}

% [DEFINITION] Complete graph K_n
% Source: implicit in paper (standard definition)
% No direct deprecated blueprint equivalent
% Lean status: ✓ Implemented in Mathlib as CompleteGraph
% Label: def:complete-graph
% Dependencies: None (standard graph theory)
% TODO: Add definition of complete graph K_n on n vertices

\begin{definition}[Complete graph]
  \label{def:complete-graph}
  \lean{CompleteGraph}
  \leanok
\end{definition}

% [DEFINITION] Edge colouring of graphs
% Source: implicit in paper (standard definition)
% Deprecated blueprint: deprecated/02_Preliminaries.tex line 3-8 (\begin{definition} \label{def:edge-colouring})
% Lean status: ✓ Implemented as SimpleGraph.EdgeColoring
% Label: def:edge-colouring
% Dependencies: def:complete-graph
% TODO: Add definition of edge colouring as map from edge set to colours

\begin{definition}[Edge colouring]
  \label{def:edge-colouring}
  \uses{def:complete-graph}
  \lean{SimpleGraph.EdgeColoring}
  \leanok
  %
  An edge colouring of a graph $G$ with colours $C$ is a map from the edge set $E(G)$ to $C$.
\end{definition}

% [DEFINITION] Colour neighbourhood
% Source: blueprint/paper/sections/section_select_and_boost_strategy.tex line 4 (notation N_i(x))
% Deprecated blueprint: deprecated/02_Preliminaries.tex line 10-16 (\begin{definition} \label{def:colour-neighborhood})
% Lean status: ✓ Implemented as SimpleGraph.EdgeColoring.coloredNeighborSet
% Label: def:colour-neighborhood
% Dependencies: def:edge-colouring
% TODO: Add definition N_i(u) for neighbourhood of vertex u in colour i

\begin{definition}[Colour neighbourhood]
  \label{def:colour-neighborhood}
  \uses{def:edge-colouring}
  \lean{SimpleGraph.EdgeColoring.coloredNeighborSet}
  \leanok
  %
  Given an edge colouring, we write $N_i(u)$ to denote the neighbourhood of vertex $u$ in colour $i$.
\end{definition}

% [DEFINITION] Function p_i(X,Y) - minimum proportion
% Source: blueprint/paper/sections/section_select_and_boost_strategy.tex line 3-4 (p_i(X,Y) definition)
% Deprecated blueprint: deprecated/02_Preliminaries.tex line 18-24 (\begin{definition} \label{def:p})
% Lean status: ✓ Partially implemented as pY in KeyLemma.lean
% Label: def:p
% Dependencies: def:colour-neighborhood
% TODO: Add definition of p_i(X,Y) = min{|N_i(x) ∩ Y|/|Y| : x ∈ X}

\begin{definition}[Function \(p_i(X,Y)\)]
  \label{def:p}
  \uses{def:colour-neighborhood}
  \lean{p}
  %
  Let $r, n\in\N$. Given sets $X,Y \subset V(K_n)$ and a colour $i \in [r]$, define
  $$p_i(X,Y) = \min\bigg\{ \frac{|N_i(x) \cap Y|}{|Y|} : x \in X \bigg\},$$
\end{definition}

% [DEFINITION] Cliques and monochromatic structures
% Source: blueprint/paper/sections/section_introduction.tex line 6 (monochromatic clique K_k)
% No deprecated blueprint equivalent
% Lean status: ✗ Not implemented
% Label: def:monochromatic-clique
% Dependencies: def:complete-graph, def:edge-colouring
% TODO: Add definition of monochromatic clique in edge coloring

\begin{definition}[Monochromatic cliques]
  \label{def:monochromatic-clique}
  \uses{def:complete-graph, def:edge-colouring}
  % Source paper defines monochromatic clique K_k in edge coloring
\end{definition}

% [DEFINITION] Ramsey numbers R_r(k)
% Source: blueprint/paper/sections/section_introduction.tex line 3-4 (informal definition)
% No deprecated blueprint equivalent
% Lean status: ✗ Not implemented
% Label: def:ramsey-number
% Dependencies: def:complete-graph, def:edge-colouring, def:monochromatic-clique
% TODO: Add definition R_r(k) = min{n : every r-coloring of E(K_n) contains monochromatic K_k}

\begin{definition}[Multicolor Ramsey numbers]
  \label{def:ramsey-number}
  \uses{def:complete-graph, def:edge-colouring, def:monochromatic-clique}
  % Source paper defines R_r(k) = min{n : every r-coloring of E(K_n) contains monochromatic K_k}
\end{definition}

% [DEFINITION] Off-diagonal Ramsey numbers R_r(k_1,...,k_r)
% Source: blueprint/paper/sections/section_the_book_theorem.tex line 7 (R_r(k,...,k,k-t))
% No deprecated blueprint equivalent
% Lean status: ✗ Not implemented
% Label: def:ramsey-number-off-diagonal
% Dependencies: def:ramsey-number
% TODO: Add definition R_r(k_1,...,k_r) for off-diagonal Ramsey numbers

\begin{definition}[Off-diagonal Ramsey numbers]
  \label{def:ramsey-number-off-diagonal}
  \uses{def:ramsey-number}
  % Source paper uses R_r(k_1,...,k_r) for off-diagonal Ramsey numbers
\end{definition}

% [DEFINITION] Books (A,B)
% Source: blueprint/paper/sections/section_the_book_theorem.tex line 3-5 (book definition)
% No deprecated blueprint equivalent
% Lean status: ✗ Not implemented
% Label: def:book
% Dependencies: def:complete-graph
% TODO: Add definition of book graph: vertex set A ∪ B, edge set {uv : {u,v} ⊄ B}
% TODO: Add definition of (t,m)-book with |A| = t and |B| = m

\begin{definition}[Books]
  \label{def:book}
  \uses{def:complete-graph}
  % Source paper defines book graph with vertex set A ∪ B, edge set {uv : {u,v} ⊄ B}
  % A (t,m)-book has |A| = t and |B| = m
\end{definition}


\subsection{Trigonometry}

% [DEFINITION] cosh√x via Taylor series
% Source: blueprint/paper/sections/section_the_proof_of_the_key_lemma.tex (implicit in special function)
% Deprecated blueprint: deprecated/02_Preliminaries.tex line 46-52 (\begin{definition} \label{def:coshsqrt})
% Lean status: ✓ Implemented as coshsqrt in Basic.lean
% Label: def:coshsqrt
% Dependencies: None (standard analysis)
% TODO: Add definition of cosh√x via Taylor expansion

\begin{definition}[cosh√x function]
  \label{def:coshsqrt} % Source paper uses same label
  \lean{coshsqrt}
  \leanok
  %
  Define $\cosh \sqrt{x}$ via its Taylor expansion
  $$\cosh\sqrt{x} = \sum_{n = 0}^\infty \frac{x^n}{(2n)!}.$$
\end{definition}

% [LEMMA] Bounds on cosh√x for positive arguments
% Source: blueprint/paper/sections/section_the_proof_of_the_key_lemma.tex line 54 (x ≤ 2 + cosh√x ≤ 3e^√x)
% Deprecated blueprint: deprecated/02_Preliminaries.tex line 90-93 (\begin{lemma} \label{lem:coshsqrt-bd-pos})
% Lean status: ✓ Implemented as `le_two_add_coshSqrt` and `coshSqrt_le` in Basic.lean
% Label: lem:coshsqrt-bd-pos
% Dependencies: def:coshsqrt
% TODO: Add bounds x ≤ 2 + cosh√x ≤ 3e^√x for x ≥ 0

\begin{lemma}[Bounds on \(\cosh\sqrt{x}\) for positive arguments]
  \label{lem:coshsqrt-bd-pos}
  \uses{def:coshsqrt}
  \lean{lt_coshsqrt}
  \leanok
  %
  $x \le 2 + \cosh \sqrt{x} \le 3 e^{\sqrt{x}}$ for every $x > 0$.
\end{lemma}
%
\begin{proof}
  For the lower-bound, using the fact that $x>0$ and all coefficients of $\cosh \sqrt{x}$ are positive,
  %
  \begin{equation*}
    2+\cosh \sqrt{x} - x \ge 2 - \frac{x}{2} + \frac{x^2}{24} = \frac{1}{2}+\frac{1}{24}(x-6)^2 \ge 0.
  \end{equation*}
  %
  For the upper bound, we observe that because by comparing coefficients,
  %
  \begin{equation*}
    e^{\sqrt{x}} = \sum 3\frac{x^{n/2}}{n!}  \ge \cosh\sqrt{x}
  \end{equation*}
  %
  Finally, $2e^{\sqrt{x}}\ge 2$ when $x>0$.
\end{proof}

% [LEMMA] Bounds on cosh√x for negative arguments
% Source: blueprint/paper/sections/section_the_proof_of_the_key_lemma.tex line 58 (cosh√x = cos√(-x), -1 ≤ cosh√x ≤ 1)
% Deprecated blueprint: deprecated/02_Preliminaries.tex line 94-97 (\begin{lemma} \label{lem:coshsqrt-bd-neg})
% Lean status: ✓ Implemented as `coshSqrt_neg` in Basic.lean
% Label: lem:coshsqrt-bd-neg
% Dependencies: def:coshsqrt
% TODO: Add bounds -1 ≤ cosh√x ≤ 1 for x < 0 via cosh√x = cos√(-x)

\begin{lemma}[Bounds on \(\cosh\sqrt{x}\) for negative arguments]
  \label{lem:coshsqrt-bd-neg}
  \uses{def:coshsqrt}
  \lean{icc_coshsqrt_neg}
  \leanok
  %
  $-1 \le \cosh \sqrt{x} \le 1$ for every $x < 0$.
\end{lemma}
%
\begin{proof}
  From the Taylor expansion, we get $\cosh \sqrt{x} = \cos \sqrt{-x}$.
\end{proof}

% [LEMMA] Lower bound 1 ≤ 2 + cosh√x
% Source: implicit (used in geometric lemma proof)
% Deprecated blueprint: deprecated/02_Preliminaries.tex line 54-63 (\begin{lemma} \label{lem:le-coshsqrt})
% Lean status: ✓ Implemented as one_le_coshsqrt in Basic.lean
% Label: lem:le-coshsqrt
% Dependencies: def:coshsqrt, lem:coshsqrt-bd-neg
% TODO: Add proof that 1 ≤ 2 + cosh√x for all x

\begin{lemma}[Lower bound for cosh√x]
  \label{lem:le-coshsqrt} % Source paper uses same label
  \uses{def:coshsqrt, lem:coshsqrt-bd-neg}
  \lean{one_le_coshsqrt}
  \leanok
  %
  For all $x \in \R$, it is $1 \le 2 + \cosh\sqrt{x}$.
\end{lemma}
%
\begin{proof}
  When $x$ is negative, we use $\cosh \sqrt{x} = \cos \sqrt{-x}\ge -1$. When $x$ is positive this is implied by the fact that all coefficients in the power series of $\cosh \sqrt{x}$ are positive.
\end{proof}

% [DEFINITION] Special function f(x₁,...,xᵣ)
% Source: blueprint/paper/sections/section_the_proof_of_the_key_lemma.tex line 43 (\begin{lemma}\label{lem:special:function})
% Deprecated blueprint: deprecated/02_Preliminaries.tex line 95-104 (\begin{definition} \label{def:f})
% Lean status: ✓ Implemented as f in Basic.lean
% Label: def:f
% Dependencies: def:coshsqrt, lem:coshsqrt-bd-neg, lem:coshsqrt-bd-pos
% TODO: Add definition f(x₁,...,xᵣ) = ∑ⱼ xⱼ ∏ᵢ≠ⱼ(2 + cosh√xᵢ)

\begin{definition}
  \label{def:f}
  \uses{def:coshsqrt, lem:coshsqrt-bd-neg, lem:coshsqrt-bd-pos}
  \lean{f}
  \leanok
  %
  Let $r \in \N$.
  %
  \begin{equation}\label{eq:f}
    f(x_1,\dots,x_r) = \sum_{j = 1}^r x_j \prod_{i \ne j} \big( 2 + \cosh\sqrt{x_i} \big).
  \end{equation}
  %
\end{definition}

% [LEMMA] Taylor coefficients are non-negative
% Source: implicit in geometric lemma proof
% Deprecated blueprint: deprecated/02_Preliminaries.tex line 106-113 (\begin{lemma} \label{lem:taylor-nonneg})
% Lean status: ✗ Not implemented
% Label: lem:taylor-nonneg
% Dependencies: def:f
% TODO: Add proof that f has non-negative Taylor coefficients

\begin{lemma}
  \label{lem:taylor-nonneg}
  \uses{def:f}
  %
  All of the coefficients of the Taylor expansion of $f$ are non-negative.
\end{lemma}
%
\begin{proof}
  By definition $2+\cosh\sqrt{x}$ has positive coefficients. It suffices to observe that the product and sum of two Taylor series with only positive coefficients has again positive coefficients. Since $f$ is such a combination of sums and products of Taylor series with only positive coefficients, we get the claim.
\end{proof}